{"version":3,"sources":["store/index.ts","layout/Layout.tsx","components/menu/Logo.tsx","components/menu/Menu.tsx","components/tool/FillTool.tsx","components/tool/PencilTool.tsx","components/tool/EyeDropperTool.tsx","components/tool/EraserTool.tsx","components/tool/Tools.tsx","components/color-palette/ColorPalette.tsx","components/pixel-canvas/canvas-fns.ts","components/pixel-canvas/PureCanvas.tsx","components/pixel-canvas/PixelCanvas.tsx","createPropGetter.ts","components/pixel-canvas/get-center-offset.ts","components/canvas-area/CanvasArea.tsx","components/canvas-area/useDimensions.ts","serviceWorker.ts","index.tsx","app/App.tsx"],"names":["storeModel","palette","selectedIndex","colors","selectColor","action","state","index","selectedColor","computed","tool","selected","brushSize","increaseBrushSize","payload","Math","max","decreaseBrushSize","canvas","width","height","zoom","maxZoom","minZoom","increaseZoom","min","decreaseZoom","store","createStore","Layout","_ref","top","left","middle","right","react_default","a","createElement","Fragment","style","display","flexDirection","color","flex","zIndex","backgroundColor","maxWidth","minWidth","boxShadow","bottom","position","Logo","alignItems","fontSize","margin","Menu","className","Logo_Logo","Icon","viewBox","d","fill","FillTool","FillTool_Icon","PencilTool","PencilTool_Icon","EyeDropperTool","EyeDropperTool_Icon","EraserTool","EraserTool_Icon","Tools","PencilTool_PencilTool","EraserTool_EraserTool","EyeDropperTool_EyeDropperTool","FillTool_FillTool","AddIcon","ColorPalette","useStoreState","useStoreActions","actions","map","i","key","onClick","minHeight","maxHeight","ColorPalette_AddIcon","setColor","canvasContext","_ref6","x","y","ctx","fillStyle","fillRect","clamp","_ref7","value","PureCanvas","React","memo","animatedProps","canvasRefCallback","bindGesture","gestureHandlers","web","Object","assign","ref","objectSpread","defaultProps","transparentGridSize","transparentFirstColor","transparentSecondColor","getProps","props","PixelCanvas","_getProps","parentDomRect","getCanvasContext","freeze","canvasRef","current","getContext","useEffect","imageSmoothingEnabled","clearRect","clear","backgroundCanvasContext","backgroundCanvasRef","_ref2","squareSize","firstColor","secondColor","columns","ceil","j","checkerBoardPattern","_useCanvasRef","useCanvasRef","_useCanvasRef2","slicedToArray","_useCanvasRef3","_useCanvasRef4","backgroundCanvasRefCallback","useGesture","onDrag","_state$previous","previous","x0","y0","_state$xy","xy","x1","y1","canvasRect","getBoundingClientRect","rectX0","floor","rectY0","rectX1","rectY1","_ref3","_ref4","withinBound","_ref5","xClamp","yClamp","dx","abs","dy","sx","sy","err","e2","line","useAnimatedCanvasProps","backgroundAnimatedProps","isBackground","useRef","callback","useCallback","node","_useSpring","useSpring","_useSpring2","setAnimatedProps","_useSpring3","_useSpring4","animatedOffsetProps","setAnimatedOffsetProps","offset","getCenterOffset","CanvasArea","_useDimensions","_ref$liveMeasure","arguments","length","undefined","liveMeasure","_useState","useState","_useState2","dimensions","setDimensions","_useState3","_useState4","setNode","useLayoutEffect","measure","window","requestAnimationFrame","addEventListener","removeEventListener","useDimensions","_useDimensions2","domRect","onWheel","event","deltaY","PixelCanvas_PixelCanvas","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","easy_peasy_esm","Layout_Layout","Menu_Menu","Tools_Tools","CanvasArea_CanvasArea","ColorPalette_ColorPalette","document","getElementById","URL","process","href","origin","concat","fetch","response","contentType","headers","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d1404275.chunk.js","sourcesContent":["import { createStore, Action, action, Computed, computed } from \"easy-peasy\";\n\ninterface PaletteModel {\n  selectedIndex: number;\n  colors: string[];\n\n  selectedColor: Computed<PaletteModel, string>;\n  selectColor: Action<PaletteModel, number>;\n}\nconst defaultPaletteModel: PaletteModel = {\n  selectedIndex: 0,\n  colors: [\n    \"#1a1c2c\",\n    \"#5d275d\",\n    \"#b13e53\",\n    \"#ef7d57\",\n    \"#ffcd75\",\n    \"#a7f070\",\n    \"#38b764\",\n    \"#257179\",\n    \"#29366f\",\n    \"#3b5dc9\",\n    \"#41a6f6\",\n    \"#73eff7\",\n    \"#f4f4f4\",\n    \"#94b0c2\",\n    \"#566c86\",\n    \"#333c57\"\n  ],\n  selectColor: action((state, index) => {\n    state.selectedIndex = index;\n  }),\n  selectedColor: computed(state => state.colors[state.selectedIndex])\n};\n\ntype ToolType = \"pencil\" | \"eraser\" | \"fill\" | \"pan\" | \"eyedropper\";\ninterface ToolModel {\n  selected: ToolType;\n  brushSize: number;\n\n  increaseBrushSize: Action<ToolModel, number>;\n  decreaseBrushSize: Action<ToolModel, number>;\n}\nconst defaultToolModel: ToolModel = {\n  selected: \"pencil\",\n  brushSize: 1,\n  increaseBrushSize: action((state, payload) => {\n    state.brushSize = Math.max(1, state.brushSize + payload);\n  }),\n  decreaseBrushSize: action((state, payload) => {\n    state.brushSize = Math.max(1, state.brushSize - payload);\n  })\n};\n\ninterface CanvasModel {\n  width: number;\n  height: number;\n  zoom: number;\n  maxZoom: number;\n  minZoom: number;\n\n  increaseZoom: Action<CanvasModel, number>;\n  decreaseZoom: Action<CanvasModel, number>;\n}\nconst defaultCanvasModel: CanvasModel = {\n  width: 20,\n  height: 20,\n  zoom: 30,\n  maxZoom: 200,\n  minZoom: 1,\n  increaseZoom: action((state, payload) => {\n    state.zoom = Math.min(state.maxZoom, state.zoom + payload);\n  }),\n  decreaseZoom: action((state, payload) => {\n    state.zoom = Math.max(state.minZoom, state.zoom - payload);\n  })\n};\n\nexport type StoreModel = {\n  palette: PaletteModel;\n  tool: ToolModel;\n  canvas: CanvasModel;\n};\n\nexport const storeModel: StoreModel = {\n  palette: defaultPaletteModel,\n  tool: defaultToolModel,\n  canvas: defaultCanvasModel\n};\n\nexport const store = createStore(storeModel);\n","import React from \"react\";\n\ninterface Props {\n  top: React.ReactElement;\n  left: React.ReactElement;\n  middle: React.ReactElement;\n  right: React.ReactElement;\n}\n\nexport const Layout: React.FC<Props> = ({ top, left, middle, right }) => {\n  return (\n    <>\n      <div\n        style={{\n          width: \"100%\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          color: \"#ADADAD\"\n        }}\n      >\n        <div style={{ flex: 0, height: 48, zIndex: 100 }}>\n          <div\n            style={{\n              backgroundColor: \"#333333\",\n              width: \"100%\",\n              height: \"100%\"\n            }}\n          >\n            {top}\n          </div>\n        </div>\n        <div style={{ flex: 1, display: \"flex\" }}>\n          <div style={{ flex: 0, maxWidth: 64, minWidth: 64, zIndex: 100 }}>\n            <div\n              style={{\n                backgroundColor: \"#2A2D2E\",\n                width: \"100%\",\n                height: \"100%\",\n                boxShadow: \"rgba(0, 0, 0, 0.4) 0px 5px 10px -10px inset\"\n              }}\n            >\n              {left}\n            </div>\n          </div>\n          <div\n            style={{\n              flex: 1\n            }}\n          />\n          <div style={{ flex: 0, maxWidth: 48, minWidth: 48, zIndex: 100 }}>\n            <div\n              style={{\n                backgroundColor: \"#2A2D2E\",\n                width: \"100%\",\n                height: \"100%\",\n                boxShadow: \"rgba(0, 0, 0, 0.4) 0px 5px 10px -10px inset\"\n              }}\n            >\n              {right}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Fixed middle */}\n      <div\n        style={{\n          bottom: \"0px\",\n          left: \"64px\",\n          right: \"48px\",\n          top: \"48px\",\n          position: \"fixed\",\n          display: \"block\"\n        }}\n      >\n        <div\n          style={{\n            backgroundColor: \"#1E1E1E\",\n            width: \"100%\",\n            height: \"100%\",\n            boxShadow: \"inset 0px 0px 5px 0px rgba(0, 0, 0, 0.4)\"\n          }}\n        >\n          {middle}\n        </div>\n      </div>\n    </>\n  );\n};\n","import React from \"react\";\n\nexport const Logo: React.FC = () => {\n  return (\n    <div style={{ display: \"flex\", height: \"100%\", alignItems: \"center\" }}>\n      <h2 style={{ fontSize: \"1.5rem\", margin: 0 }}>Pixely</h2>\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"./Menu.css\";\nimport { Logo } from \"./Logo\";\n\ninterface Props {}\n\nexport const Menu: React.FC<Props> = () => {\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        display: \"inline-flex\",\n        alignItems: \"center\"\n      }}\n    >\n      <div className={\"Menu-items\"}>\n        <Logo />\n      </div>\n      <button className={\"Menu-items Menu-button\"}>File</button>\n      <button className={\"Menu-items Menu-button\"}>Edit</button>\n      <button className={\"Menu-items Menu-button\"}>Help</button>\n    </div>\n  );\n};\n","import React from \"react\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg\n      viewBox=\"0 0 18.713 18.713\"\n      width=\"32\"\n      height=\"32\"\n    >\n      <path\n        d=\"M13.367,6.434L8.872,1.895l-0.65-0.672L6.687,2.731c-2.624-0.375-4.51,0.59-5.178,1.777   C0.698,5.949,1.527,7.522,1.553,7.57c0.693,1.385,1.689,2.216,2.961,2.473c0.279,0.055,0.56,0.08,0.84,0.08   c1.322,0,2.644-0.561,3.649-1.135c0.271,0.188,0.601,0.299,0.954,0.299c0.93,0,1.686-0.759,1.686-1.691s-0.756-1.69-1.686-1.69   s-1.686,0.758-1.686,1.69c0,0.093,0.013,0.184,0.027,0.274C7.286,8.445,5.951,8.986,4.77,8.748C3.905,8.573,3.237,7.995,2.719,6.96   C2.714,6.95,2.203,5.957,2.654,5.157c0.38-0.676,1.371-1.111,2.883-1.275L5.302,4.119L3.13,6.299   c0.023,0.053,0.04,0.085,0.041,0.087c0.209,0.418,0.444,0.758,0.706,1.03l3.932-3.943c0.187-0.187,0.435-0.29,0.698-0.29   s0.513,0.103,0.698,0.29l4.771,4.787c0.385,0.385,0.385,1.014,0,1.399L7.774,15.88c-0.372,0.373-1.023,0.373-1.396,0l-4.772-4.787   c-0.187-0.186-0.289-0.434-0.289-0.699c0-0.264,0.102-0.514,0.289-0.7l0.515-0.518C1.828,8.874,1.568,8.512,1.335,8.098   l-0.66,0.663C0.24,9.197,0,9.777,0,10.394c0,0.617,0.24,1.197,0.675,1.633l4.772,4.787c0.435,0.436,1.012,0.676,1.628,0.676   c0.614,0,1.193-0.24,1.628-0.676l6.201-6.221L16.205,9.3l-0.361-0.365c0.683-0.373,0.987,2.744,0.987,2.744s0.954,7.439,1.802,0   C19.443,4.56,13.854,6.272,13.367,6.434z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const FillTool: React.FC = () => {\n  return <Icon />;\n};\n","import React from \"react\";\n// import { useStoreActions, useStoreState } from \"easy-peasy\";\n// import { StoreModel } from \"../../store\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg\n      width=\"32\"\n      height=\"32\"\n      viewBox=\"0 0 1792 1792\"\n    >\n      <path\n        d=\"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const PencilTool: React.FC = () => {\n  // const brushSize = useStoreState<StoreModel>(state => state.tool.brushSize);\n  // const increaseBrushSize = useStoreActions<StoreModel>(\n  //   actions => actions.tool.increaseBrushSize\n  // );\n  // const decreaseBrushSize = useStoreActions<StoreModel>(\n  //   actions => actions.tool.decreaseBrushSize\n  // );\n\n  // const handleIncreaseClick = () => {\n  //   increaseBrushSize(1);\n  // };\n  // const handleDecreaseClick = () => () => {\n  //   decreaseBrushSize(1);\n  // };\n\n  // // zoom\n  // const zoom = useStoreState<StoreModel>(state => state.canvas.zoom);\n  // const increaseZoom = useStoreActions<StoreModel>(\n  //   actions => actions.canvas.increaseZoom\n  // );\n  // const decreaseZoom = useStoreActions<StoreModel>(\n  //   actions => actions.canvas.decreaseZoom\n  // );\n\n  // const handleIncreaseZoomClick = () => {\n  //   increaseZoom(2);\n  // };\n  // const handleDecreaseZoomClick = () => {\n  //   decreaseZoom(2);\n  // };\n\n  return (\n    <Icon />\n    // <>\n    //   <div>\n    //     <span>Pencil Tool:&nbsp;</span>\n    //     <button onClick={handleIncreaseClick}>+</button>\n    //     <span>{brushSize}</span>\n    //     <button onClick={handleDecreaseClick}>-</button>\n    //   </div>\n\n    //   <div>\n    //     <span>Zoom Tool:&nbsp;</span>\n    //     <button onClick={handleIncreaseZoomClick}>+</button>\n    //     <span>{zoom}</span>\n    //     <button onClick={handleDecreaseZoomClick}>-</button>\n    //   </div>\n    // </>\n  );\n};\n","import React from \"react\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg width=\"32\" height=\"32\" viewBox=\"0 0 1792 1792\">\n      <path\n        d=\"M1698 94q94 94 94 226.5t-94 225.5l-225 223 104 104q10 10 10 23t-10 23l-210 210q-10 10-23 10t-23-10l-105-105-603 603q-37 37-90 37h-203l-256 128-64-64 128-256v-203q0-53 37-90l603-603-105-105q-10-10-10-23t10-23l210-210q10-10 23-10t23 10l104 104 223-225q93-94 225.5-94t226.5 94zm-1186 1378l576-576-192-192-576 576v192h192z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const EyeDropperTool: React.FC = () => {\n  return <Icon />;\n};\n","import React from \"react\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg width=\"32\" height=\"32\" viewBox=\"0 0 1792 1792\">\n      <path\n        d=\"M832 1408l336-384h-768l-336 384h768zm1013-1077q15 34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38 0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38 0 69.5 20.5t47.5 54.5z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const EraserTool: React.FC = () => {\n  return <Icon />;\n};\n","import React from \"react\";\nimport \"./Tools.css\";\nimport { FillTool } from \"./FillTool\";\nimport { PencilTool } from \"./PencilTool\";\nimport { EyeDropperTool } from \"./EyeDropperTool\";\nimport { EraserTool } from \"./EraserTool\";\n\nexport const Tools: React.FC = () => {\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\"\n      }}\n    >\n      <button className={\"Tools-items Tools-button\"}>\n        <PencilTool />\n      </button>\n      <button className={\"Tools-items Tools-button\"}>\n        <EraserTool />\n      </button>\n      <button className={\"Tools-items Tools-button\"}>\n        <EyeDropperTool />\n      </button>\n      <button className={\"Tools-items Tools-button\"}>\n        <FillTool />\n      </button>\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"./ColorPalette.css\";\nimport { useStoreState, useStoreActions } from \"easy-peasy\";\nimport { StoreModel } from \"../../store\";\n\nconst AddIcon: React.FC = () => {\n  return (\n    <svg width=\"30\" height=\"30\" viewBox=\"0 0 1792 1792\">\n      <path\n        d=\"M1600 736v192q0 40-28 68t-68 28h-416v416q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-416h-416q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h416v-416q0-40 28-68t68-28h192q40 0 68 28t28 68v416h416q40 0 68 28t28 68z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const ColorPalette: React.FC = () => {\n  const colors = useStoreState<StoreModel, string[]>(\n    state => state.palette.colors\n  );\n\n  const selectColor = useStoreActions<StoreModel>(\n    actions => actions.palette.selectColor\n  );\n\n  const handleClick = (index: number) => () => {\n    selectColor(index);\n  };\n\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\"\n      }}\n    >\n      {colors.map((color, i) => (\n        <button\n          key={i}\n          onClick={handleClick(i)}\n          className={\"ColorPalette-items ColorPalette-button\"}\n          style={{\n            backgroundColor: color,\n            flex: 1\n          }}\n        />\n      ))}\n\n      <button className={\"ColorPalette-items ColorPalette-button\"} style={{ minHeight: 48, maxHeight: 48, flex: 0 }}>\n        <AddIcon />\n      </button>\n    </div>\n  );\n};\n","import { Color } from \"csstype\";\n\nexport interface CanvasContext {\n  ctx: CanvasRenderingContext2D;\n  width: number;\n  height: number;\n  brushSize: number;\n}\n\nexport const clear = ({ ctx, width, height }: CanvasContext) => {\n  ctx.clearRect(0, 0, width, height);\n};\n\nexport const checkerBoardPattern = (\n  canvasContext: CanvasContext,\n  {\n    squareSize,\n    firstColor,\n    secondColor\n  }: { squareSize: number; firstColor: string; secondColor: string }\n) => {\n  const { width, height } = canvasContext;\n  const columns = Math.ceil(width / squareSize);\n  let color = firstColor;\n\n  for (let i = 0; i < height; i += squareSize) {\n    for (let j = 0; j < width; j += squareSize) {\n      setColor(\n        {\n          ...canvasContext,\n          brushSize: squareSize\n        },\n        {\n          x: j,\n          y: i,\n          color\n        }\n      );\n      color = color === firstColor ? secondColor : firstColor;\n    }\n\n    // flip again if even columns\n    if (columns % 2 === 0) {\n      color = color === firstColor ? secondColor : firstColor;\n    }\n  }\n};\n\nexport const withinBound = (\n  { width, height }: CanvasContext,\n  { x, y }: { x: number; y: number }\n) => {\n  if (x < 0 || x >= width || y < 0 || y >= height) {\n    return false;\n  }\n  return true;\n};\n\nexport const line = (\n  canvasContext: CanvasContext,\n  {\n    x0,\n    y0,\n    x1,\n    y1,\n    color\n  }: {\n    x0: number;\n    y0: number;\n    x1: number;\n    y1: number;\n    color: string;\n  }\n) => {\n  const { width, height } = canvasContext;\n  const xClamp = clamp({\n    min: 0,\n    max: width - 1\n  });\n  const yClamp = clamp({\n    min: 0,\n    max: height - 1\n  });\n\n  x0 = xClamp(x0);\n  y0 = yClamp(y0);\n  x1 = xClamp(x1);\n  y1 = yClamp(y1);\n\n  const dx = Math.abs(x1 - x0);\n  const dy = Math.abs(y1 - y0);\n  const sx = x0 < x1 ? 1 : -1;\n  const sy = y0 < y1 ? 1 : -1;\n  let err = dx - dy;\n\n  while (true) {\n    setColor(canvasContext, { x: x0, y: y0, color });\n\n    //if we've reached the end goal, exit the loop\n    if (x0 === x1 && y0 === y1) {\n      break;\n    }\n    const e2 = 2 * err;\n    if (e2 > -dy) {\n      err -= dy;\n      x0 += sx;\n    }\n    if (e2 < dx) {\n      err += dx;\n      y0 += sy;\n    }\n  }\n};\n\nexport const setColor = (\n  canvasContext: CanvasContext,\n  { x, y, color }: { x: number; y: number; color: Color }\n) => {\n  const { ctx, brushSize } = canvasContext;\n  ctx.fillStyle = color;\n  ctx.fillRect(x, y, brushSize, brushSize);\n};\n\nconst clamp = ({ min, max }: { min: number; max: number }) => (\n  value: number\n) => {\n  return Math.min(Math.max(value, min), max);\n};\n","import React from \"react\";\nimport { ReactEventHandlers } from \"react-use-gesture/events\";\nimport \"./Canvas.css\";\nimport { animated } from \"react-spring\";\n\ninterface Props {\n  width: number;\n  height: number;\n  animatedProps: React.CSSProperties;\n  canvasRefCallback?: (instance: HTMLCanvasElement) => void;\n  bindGesture?: (...args: any[]) => ReactEventHandlers;\n  style?: React.CSSProperties;\n  className?: string;\n}\n\nconst _PureCanvas: React.FC<Props> = ({\n  width,\n  height,\n  animatedProps,\n  canvasRefCallback,\n  bindGesture,\n  style,\n  className\n}) => {\n  const gestureHandlers = bindGesture ? bindGesture() : {};\n  return (\n    <animated.canvas\n      {...gestureHandlers}\n      ref={canvasRefCallback}\n      width={width}\n      height={height}\n      className={\"Canvas-pixelated \" + className}\n      style={{ ...style, ...animatedProps }}\n    />\n  );\n};\n\nexport const PureCanvas = React.memo(_PureCanvas);\n","import React, { useRef, useEffect, useCallback } from \"react\";\nimport {\n  CanvasContext,\n  clear,\n  line,\n  withinBound,\n  checkerBoardPattern\n} from \"./canvas-fns\";\nimport { getCenterOffset } from \"./get-center-offset\";\nimport { useStoreState } from \"easy-peasy\";\nimport { StoreModel } from \"../../store\";\nimport { PureCanvas } from \"./PureCanvas\";\nimport { useGesture } from \"react-use-gesture\";\nimport { useSpring } from \"react-spring\";\nimport { createPropGetter } from \"../../createPropGetter\";\n\ntype Props = {\n  parentDomRect: DOMRect;\n} & Partial<DefaultProps>;\n\nconst defaultProps = {\n  transparentGridSize: 2,\n  transparentFirstColor: \"#B4AEB7\",\n  transparentSecondColor: \"#CCC8CE\"\n};\ntype DefaultProps = Readonly<typeof defaultProps>;\nconst getProps = createPropGetter(defaultProps);\n\nexport const PixelCanvas: React.FC<Props> = props => {\n  const {\n    parentDomRect,\n    transparentGridSize,\n    transparentFirstColor,\n    transparentSecondColor\n  } = getProps(props);\n\n  const selectedColor = useStoreState<StoreModel>(\n    state => state.palette.selectedColor\n  );\n  const brushSize = useStoreState<StoreModel>(state => state.tool.brushSize);\n  const zoom = useStoreState<StoreModel>(state => state.canvas.zoom);\n  const width = useStoreState<StoreModel>(state => state.canvas.width);\n  const height = useStoreState<StoreModel>(state => state.canvas.height);\n\n  const getCanvasContext = (\n    ref?: React.MutableRefObject<HTMLCanvasElement | undefined>\n  ): CanvasContext => {\n    return Object.freeze({\n      ctx: (ref ? ref : canvasRef).current!.getContext(\"2d\")!,\n      width,\n      height,\n      brushSize\n    } as CanvasContext);\n  };\n\n  // canvas setup\n  useEffect(() => {\n    const canvasContext = getCanvasContext();\n    canvasContext.ctx.imageSmoothingEnabled = true;\n    clear(canvasContext);\n\n    const backgroundCanvasContext = getCanvasContext(backgroundCanvasRef);\n    backgroundCanvasContext.ctx.imageSmoothingEnabled = true;\n    checkerBoardPattern(backgroundCanvasContext, {\n      squareSize: transparentGridSize,\n      firstColor: transparentFirstColor,\n      secondColor: transparentSecondColor\n    });\n\n    // eslint-disable-next-line\n  }, []);\n\n  // canvas ref callback\n  const [canvasRef, canvasRefCallback] = useCanvasRef();\n  const [backgroundCanvasRef, backgroundCanvasRefCallback] = useCanvasRef();\n\n  // gesture for canvas\n  const bindGesture = useGesture({\n    onDrag: state => {\n      const [x0, y0] = state.previous;\n      const [x1, y1] = state.xy;\n      const canvas = canvasRef.current!;\n      const canvasRect = canvas.getBoundingClientRect();\n\n      const rectX0 = Math.floor((x0 - canvasRect.left) / zoom);\n      const rectY0 = Math.floor((y0 - canvasRect.top) / zoom);\n      const rectX1 = Math.floor((x1 - canvasRect.left) / zoom);\n      const rectY1 = Math.floor((y1 - canvasRect.top) / zoom);\n\n      // ignore if previous pos out of bound\n      if (!withinBound(getCanvasContext(), { x: rectX0, y: rectY0 })) {\n        return;\n      }\n\n      line(getCanvasContext(), {\n        x0: rectX0,\n        y0: rectY0,\n        x1: rectX1,\n        y1: rectY1,\n        color: selectedColor\n      });\n    }\n  });\n\n  const animatedProps = useAnimatedCanvasProps({\n    width,\n    height,\n    zoom,\n    parentDomRect\n  });\n  const backgroundAnimatedProps = useAnimatedCanvasProps({\n    width,\n    height,\n    zoom,\n    parentDomRect,\n    isBackground: true\n  });\n\n  return (\n    <>\n      <PureCanvas\n        canvasRefCallback={canvasRefCallback}\n        width={width}\n        height={height}\n        bindGesture={bindGesture}\n        animatedProps={animatedProps}\n        className={\"Canvas-main\"}\n      />\n      <PureCanvas\n        canvasRefCallback={backgroundCanvasRefCallback}\n        width={width}\n        height={height}\n        animatedProps={backgroundAnimatedProps}\n      />\n    </>\n  );\n};\n\nPixelCanvas.defaultProps = defaultProps;\n\nconst useCanvasRef = (): [\n  React.MutableRefObject<HTMLCanvasElement>,\n  (node: any) => void\n] => {\n  const ref = useRef<HTMLCanvasElement>();\n  const callback = useCallback(node => {\n    if (node) {\n      ref.current = node;\n    }\n  }, []);\n  return [ref as React.MutableRefObject<HTMLCanvasElement>, callback];\n};\n\nconst useAnimatedCanvasProps = ({\n  width,\n  height,\n  zoom,\n  parentDomRect,\n  isBackground\n}: {\n  width: number;\n  height: number;\n  zoom: number;\n  parentDomRect: DOMRect;\n  isBackground?: boolean;\n}): React.CSSProperties => {\n  const [animatedProps, setAnimatedProps] = useSpring(() => {\n    return {\n      width: zoom * width + (isBackground ? 1 : 0),\n      height: zoom * height + (isBackground ? 1 : 0)\n    };\n  });\n  useEffect(() => {\n    const w = zoom * width + (isBackground ? 1 : 0);\n    const h = zoom * height + (isBackground ? 1 : 0);\n    setAnimatedProps({\n      width: w,\n      height: h\n    });\n  }, [width, height, zoom, setAnimatedProps, isBackground]);\n\n  // TODO: enable pan and zoom control offset\n  const [animatedOffsetProps, setAnimatedOffsetProps] = useSpring(() => {\n    return {\n      left: 0,\n      top: 0\n    };\n  });\n  useEffect(() => {\n    const w = zoom * width;\n    const h = zoom * height;\n    const offset = parentDomRect\n      ? getCenterOffset({ parentDomRect, width: w, height: h })\n      : {};\n\n    setAnimatedOffsetProps({\n      ...offset\n    });\n  }, [width, height, zoom, setAnimatedOffsetProps, parentDomRect]);\n\n  return { ...animatedProps, ...animatedOffsetProps };\n  // return { ...animatedProps };\n};\n","export const createPropGetter = <DP extends object>(defaultProps: DP) => {\n    return <P extends Partial<DP>>(props: P) => {\n        type PropsExcludingDefaults = Pick<P, Exclude<keyof P, keyof DP>>\n        type RecomposedProps = DP & PropsExcludingDefaults\n        return (props as any) as RecomposedProps\n    }\n}","export const getCenterOffset = ({\n  parentDomRect,\n  width,\n  height\n}: {\n  parentDomRect: DOMRect;\n  width: number;\n  height: number;\n}): { left: number; top: number } => {\n  return {\n    left: Math.floor((parentDomRect.width - width) / 2),\n    top: Math.floor((parentDomRect.height - height) / 2)\n  };\n};\n","import React from \"react\";\nimport { useDimensions } from \"./useDimensions\";\nimport { PixelCanvas } from \"../pixel-canvas\";\nimport { useStoreActions } from \"easy-peasy\";\nimport { StoreModel } from \"../../store\";\n\nexport const CanvasArea: React.FC = () => {\n  const [ref, domRect] = useDimensions();\n  const increaseZoom = useStoreActions<StoreModel>(\n    actions => actions.canvas.increaseZoom\n  );\n  const decreaseZoom = useStoreActions<StoreModel>(\n    actions => actions.canvas.decreaseZoom\n  );\n\n  const handleWheel = (event: React.WheelEvent) => {\n    const deltaY = event.deltaY;\n    if (deltaY < 0) {\n      increaseZoom(-deltaY / 30);\n    } else {\n      decreaseZoom(deltaY / 30);\n    }\n  };\n\n  return (\n    <div\n      ref={ref}\n      onWheel={handleWheel}\n      style={{ width: \"100%\", height: \"100%\" }}\n    >\n      <PixelCanvas parentDomRect={domRect} />\n    </div>\n  );\n};\n","import { useState, useCallback, useLayoutEffect } from \"react\";\n\ntype UseDimensionsHook = [any, DOMRect, HTMLElement];\n\ninterface UseDimensionsArgs {\n  liveMeasure?: boolean;\n}\n\nexport const useDimensions = ({\n  liveMeasure = true\n}: UseDimensionsArgs = {}): UseDimensionsHook => {\n  const [dimensions, setDimensions] = useState<DOMRect>();\n  const [node, setNode] = useState();\n\n  const ref = useCallback(node => {\n    if (node) {\n      setNode(node);\n    }\n  }, []);\n\n  useLayoutEffect(() => {\n    if (node) {\n      const measure = () => {\n        window.requestAnimationFrame(() =>\n          setDimensions(node.getBoundingClientRect() as DOMRect)\n        );\n      };\n      measure();\n\n      if (liveMeasure) {\n        window.addEventListener(\"resize\", measure);\n        window.addEventListener(\"scroll\", measure);\n\n        return () => {\n          window.removeEventListener(\"resize\", measure);\n          window.removeEventListener(\"scroll\", measure);\n        };\n      }\n    }\n  }, [node, liveMeasure]);\n\n  return [ref, dimensions!, node];\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport { App } from \"./app\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n","import React from \"react\";\nimport { StoreProvider } from \"easy-peasy\";\nimport { store } from \"./../store\";\nimport { Layout } from \"../layout\";\nimport { Menu } from \"../components/menu\";\nimport { Tools } from \"../components/tool\";\nimport { ColorPalette } from \"../components/color-palette\";\nimport { CanvasArea } from \"../components/canvas-area\";\n\nexport const App: React.FC = () => {\n  return (\n    <StoreProvider store={store as any}>\n      <Layout\n        top={<Menu />}\n        left={<Tools />}\n        middle={<CanvasArea />}\n        right={<ColorPalette />}\n      />\n    </StoreProvider>\n  );\n};\n"],"sourceRoot":""}