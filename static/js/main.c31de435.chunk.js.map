{"version":3,"sources":["store/index.ts","layout/Layout.tsx","components/menu/Logo.tsx","components/menu/Menu.tsx","components/tool/FillTool.tsx","components/tool/PencilTool.tsx","components/tool/EyeDropperTool.tsx","components/tool/EraserTool.tsx","components/tool/Tools.tsx","hooks.ts","components/color-palette/ColorPalette.tsx","components/pixel-canvas/canvas-fns.ts","components/pixel-canvas/PureCanvas.tsx","components/pixel-canvas/PixelCanvas.tsx","createPropGetter.ts","components/canvas-area/CanvasArea.tsx","components/canvas-area/useDimensions.ts","app/App.tsx","serviceWorker.ts","index.tsx"],"names":["storeModel","palette","selectedIndex","colors","selectColor","action","state","index","selectedColor","computed","tool","selected","brushSize","increaseBrushSize","payload","Math","max","decreaseBrushSize","canvas","width","height","zoom","maxZoom","minZoom","increaseZoom","min","decreaseZoom","store","createStore","Layout","top","left","middle","right","style","display","flexDirection","color","flex","zIndex","backgroundColor","maxWidth","minWidth","boxShadow","bottom","position","Logo","alignItems","fontSize","margin","Menu","className","Icon","viewBox","d","fill","FillTool","PencilTool","EyeDropperTool","EraserTool","Tools","typedHooks","createTypedHooks","useStoreActions","useStoreState","useStoreDispatch","AddIcon","ColorPalette","actions","map","i","key","onClick","minHeight","maxHeight","setColor","canvasContext","x","y","ctx","fillStyle","fillRect","clamp","value","PureCanvas","React","memo","animatedStyleProps","canvasRefCallback","bindGesture","gestureHandlers","ref","defaultProps","transparentGridSize","transparentFirstColor","transparentSecondColor","getProps","props","PixelCanvas","getCanvasContext","Object","freeze","canvasRef","current","getContext","useEffect","imageSmoothingEnabled","clearRect","clear","backgroundCanvasContext","backgroundCanvasRef","squareSize","firstColor","secondColor","columns","ceil","j","checkerBoardPattern","useCanvasRef","backgroundCanvasRefCallback","useGesture","onDrag","previous","x0","y0","xy","x1","y1","canvasRect","getBoundingClientRect","rectX0","floor","rectY0","rectX1","rectY1","withinBound","xClamp","yClamp","dx","abs","dy","sx","sy","err","e2","line","useRef","callback","useCallback","node","CanvasArea","liveMeasure","useState","dimensions","setDimensions","setNode","useLayoutEffect","measure","window","requestAnimationFrame","domRect","addEventListener","removeEventListener","useDimensions","wheelXy","setWheelXy","useAnimatedCanvasProps","parentDomRect","onWheel","event","deltaY","clientX","clientY","toEven","val","useSpring","animatedProps","setAnimatedProps","previousZoom","usePrevious","animatedOffsetProps","setAnimatedOffsetProps","canvasOffset","setCanvasOffset","initialized","setInitialized","wheelRelative","leftDelta","rightDelta","App","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","document","getElementById","URL","process","href","origin","fetch","response","contentType","headers","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.c31de435.chunk.js","sourcesContent":["import { createStore, Action, action, Computed, computed } from \"easy-peasy\";\n\ninterface PaletteModel {\n  selectedIndex: number;\n  colors: string[];\n\n  selectedColor: Computed<PaletteModel, string>;\n  selectColor: Action<PaletteModel, number>;\n}\nconst defaultPaletteModel: PaletteModel = {\n  selectedIndex: 0,\n  colors: [\n    \"#1a1c2c\",\n    \"#5d275d\",\n    \"#b13e53\",\n    \"#ef7d57\",\n    \"#ffcd75\",\n    \"#a7f070\",\n    \"#38b764\",\n    \"#257179\",\n    \"#29366f\",\n    \"#3b5dc9\",\n    \"#41a6f6\",\n    \"#73eff7\",\n    \"#f4f4f4\",\n    \"#94b0c2\",\n    \"#566c86\",\n    \"#333c57\",\n  ],\n  selectColor: action((state, index) => {\n    state.selectedIndex = index;\n  }),\n  selectedColor: computed((state) => state.colors[state.selectedIndex]),\n};\n\ntype ToolType = \"pencil\" | \"eraser\" | \"fill\" | \"pan\" | \"eyedropper\";\ninterface ToolModel {\n  selected: ToolType;\n  brushSize: number;\n\n  increaseBrushSize: Action<ToolModel, number>;\n  decreaseBrushSize: Action<ToolModel, number>;\n}\nconst defaultToolModel: ToolModel = {\n  selected: \"pencil\",\n  brushSize: 1,\n  increaseBrushSize: action((state, payload) => {\n    state.brushSize = Math.max(1, state.brushSize + payload);\n  }),\n  decreaseBrushSize: action((state, payload) => {\n    state.brushSize = Math.max(1, state.brushSize - payload);\n  }),\n};\n\ninterface CanvasModel {\n  width: number;\n  height: number;\n  zoom: number;\n  maxZoom: number;\n  minZoom: number;\n\n  increaseZoom: Action<CanvasModel, number>;\n  decreaseZoom: Action<CanvasModel, number>;\n}\nconst defaultCanvasModel: CanvasModel = {\n  width: 20,\n  height: 20,\n  zoom: 30,\n  maxZoom: 200,\n  minZoom: 1,\n  increaseZoom: action((state, payload) => {\n    state.zoom = Math.min(state.maxZoom, state.zoom + payload);\n  }),\n  decreaseZoom: action((state, payload) => {\n    state.zoom = Math.max(state.minZoom, state.zoom - payload);\n  }),\n};\n\nexport interface StoreModel {\n  palette: PaletteModel;\n  tool: ToolModel;\n  canvas: CanvasModel;\n}\n\nexport const storeModel: StoreModel = {\n  palette: defaultPaletteModel,\n  tool: defaultToolModel,\n  canvas: defaultCanvasModel,\n};\n\nexport const store = createStore(storeModel);\n","import React from \"react\";\n\ninterface Props {\n  top: React.ReactElement;\n  left: React.ReactElement;\n  middle: React.ReactElement;\n  right: React.ReactElement;\n}\n\nexport const Layout: React.FC<Props> = ({ top, left, middle, right }) => {\n  return (\n    <>\n      <div\n        style={{\n          width: \"100%\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          color: \"#ADADAD\"\n        }}\n      >\n        <div style={{ flex: 0, height: 48, zIndex: 100 }}>\n          <div\n            style={{\n              backgroundColor: \"#333333\",\n              width: \"100%\",\n              height: \"100%\"\n            }}\n          >\n            {top}\n          </div>\n        </div>\n        <div style={{ flex: 1, display: \"flex\" }}>\n          <div style={{ flex: 0, maxWidth: 64, minWidth: 64, zIndex: 100 }}>\n            <div\n              style={{\n                backgroundColor: \"#2A2D2E\",\n                width: \"100%\",\n                height: \"100%\",\n                boxShadow: \"rgba(0, 0, 0, 0.4) 0px 5px 10px -10px inset\"\n              }}\n            >\n              {left}\n            </div>\n          </div>\n          <div\n            style={{\n              flex: 1\n            }}\n          />\n          <div style={{ flex: 0, maxWidth: 48, minWidth: 48, zIndex: 100 }}>\n            <div\n              style={{\n                backgroundColor: \"#2A2D2E\",\n                width: \"100%\",\n                height: \"100%\",\n                boxShadow: \"rgba(0, 0, 0, 0.4) 0px 5px 10px -10px inset\"\n              }}\n            >\n              {right}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Fixed middle */}\n      <div\n        style={{\n          bottom: \"0px\",\n          left: \"64px\",\n          right: \"48px\",\n          top: \"48px\",\n          position: \"fixed\",\n          display: \"block\"\n        }}\n      >\n        <div\n          style={{\n            backgroundColor: \"#1E1E1E\",\n            width: \"100%\",\n            height: \"100%\",\n            boxShadow: \"inset 0px 0px 5px 0px rgba(0, 0, 0, 0.4)\"\n          }}\n        >\n          {middle}\n        </div>\n      </div>\n    </>\n  );\n};\n","import React from \"react\";\n\nexport const Logo: React.FC = () => {\n  return (\n    <div style={{ display: \"flex\", height: \"100%\", alignItems: \"center\" }}>\n      <h2 style={{ fontSize: \"1.5rem\", margin: 0 }}>Pixely</h2>\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"./Menu.css\";\nimport { Logo } from \"./Logo\";\n\ninterface Props {}\n\nexport const Menu: React.FC<Props> = () => {\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        display: \"inline-flex\",\n        alignItems: \"center\"\n      }}\n    >\n      <div className={\"Menu-items\"}>\n        <Logo />\n      </div>\n      <button className={\"Menu-items Menu-button\"}>File</button>\n      <button className={\"Menu-items Menu-button\"}>Edit</button>\n      <button className={\"Menu-items Menu-button\"}>Help</button>\n    </div>\n  );\n};\n","import React from \"react\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg\n      viewBox=\"0 0 18.713 18.713\"\n      width=\"32\"\n      height=\"32\"\n    >\n      <path\n        d=\"M13.367,6.434L8.872,1.895l-0.65-0.672L6.687,2.731c-2.624-0.375-4.51,0.59-5.178,1.777   C0.698,5.949,1.527,7.522,1.553,7.57c0.693,1.385,1.689,2.216,2.961,2.473c0.279,0.055,0.56,0.08,0.84,0.08   c1.322,0,2.644-0.561,3.649-1.135c0.271,0.188,0.601,0.299,0.954,0.299c0.93,0,1.686-0.759,1.686-1.691s-0.756-1.69-1.686-1.69   s-1.686,0.758-1.686,1.69c0,0.093,0.013,0.184,0.027,0.274C7.286,8.445,5.951,8.986,4.77,8.748C3.905,8.573,3.237,7.995,2.719,6.96   C2.714,6.95,2.203,5.957,2.654,5.157c0.38-0.676,1.371-1.111,2.883-1.275L5.302,4.119L3.13,6.299   c0.023,0.053,0.04,0.085,0.041,0.087c0.209,0.418,0.444,0.758,0.706,1.03l3.932-3.943c0.187-0.187,0.435-0.29,0.698-0.29   s0.513,0.103,0.698,0.29l4.771,4.787c0.385,0.385,0.385,1.014,0,1.399L7.774,15.88c-0.372,0.373-1.023,0.373-1.396,0l-4.772-4.787   c-0.187-0.186-0.289-0.434-0.289-0.699c0-0.264,0.102-0.514,0.289-0.7l0.515-0.518C1.828,8.874,1.568,8.512,1.335,8.098   l-0.66,0.663C0.24,9.197,0,9.777,0,10.394c0,0.617,0.24,1.197,0.675,1.633l4.772,4.787c0.435,0.436,1.012,0.676,1.628,0.676   c0.614,0,1.193-0.24,1.628-0.676l6.201-6.221L16.205,9.3l-0.361-0.365c0.683-0.373,0.987,2.744,0.987,2.744s0.954,7.439,1.802,0   C19.443,4.56,13.854,6.272,13.367,6.434z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const FillTool: React.FC = () => {\n  return <Icon />;\n};\n","import React from \"react\";\n// import { useStoreActions, useStoreState } from \"easy-peasy\";\n// import { StoreModel } from \"../../store\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg\n      width=\"32\"\n      height=\"32\"\n      viewBox=\"0 0 1792 1792\"\n    >\n      <path\n        d=\"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const PencilTool: React.FC = () => {\n  // const brushSize = useStoreState<StoreModel>(state => state.tool.brushSize);\n  // const increaseBrushSize = useStoreActions<StoreModel>(\n  //   actions => actions.tool.increaseBrushSize\n  // );\n  // const decreaseBrushSize = useStoreActions<StoreModel>(\n  //   actions => actions.tool.decreaseBrushSize\n  // );\n\n  // const handleIncreaseClick = () => {\n  //   increaseBrushSize(1);\n  // };\n  // const handleDecreaseClick = () => () => {\n  //   decreaseBrushSize(1);\n  // };\n\n  // // zoom\n  // const zoom = useStoreState<StoreModel>(state => state.canvas.zoom);\n  // const increaseZoom = useStoreActions<StoreModel>(\n  //   actions => actions.canvas.increaseZoom\n  // );\n  // const decreaseZoom = useStoreActions<StoreModel>(\n  //   actions => actions.canvas.decreaseZoom\n  // );\n\n  // const handleIncreaseZoomClick = () => {\n  //   increaseZoom(2);\n  // };\n  // const handleDecreaseZoomClick = () => {\n  //   decreaseZoom(2);\n  // };\n\n  return (\n    <Icon />\n    // <>\n    //   <div>\n    //     <span>Pencil Tool:&nbsp;</span>\n    //     <button onClick={handleIncreaseClick}>+</button>\n    //     <span>{brushSize}</span>\n    //     <button onClick={handleDecreaseClick}>-</button>\n    //   </div>\n\n    //   <div>\n    //     <span>Zoom Tool:&nbsp;</span>\n    //     <button onClick={handleIncreaseZoomClick}>+</button>\n    //     <span>{zoom}</span>\n    //     <button onClick={handleDecreaseZoomClick}>-</button>\n    //   </div>\n    // </>\n  );\n};\n","import React from \"react\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg width=\"32\" height=\"32\" viewBox=\"0 0 1792 1792\">\n      <path\n        d=\"M1698 94q94 94 94 226.5t-94 225.5l-225 223 104 104q10 10 10 23t-10 23l-210 210q-10 10-23 10t-23-10l-105-105-603 603q-37 37-90 37h-203l-256 128-64-64 128-256v-203q0-53 37-90l603-603-105-105q-10-10-10-23t10-23l210-210q10-10 23-10t23 10l104 104 223-225q93-94 225.5-94t226.5 94zm-1186 1378l576-576-192-192-576 576v192h192z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const EyeDropperTool: React.FC = () => {\n  return <Icon />;\n};\n","import React from \"react\";\n\nconst Icon: React.FC = () => {\n  return (\n    <svg width=\"32\" height=\"32\" viewBox=\"0 0 1792 1792\">\n      <path\n        d=\"M832 1408l336-384h-768l-336 384h768zm1013-1077q15 34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38 0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38 0 69.5 20.5t47.5 54.5z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const EraserTool: React.FC = () => {\n  return <Icon />;\n};\n","import React from \"react\";\nimport \"./Tools.css\";\nimport { FillTool } from \"./FillTool\";\nimport { PencilTool } from \"./PencilTool\";\nimport { EyeDropperTool } from \"./EyeDropperTool\";\nimport { EraserTool } from \"./EraserTool\";\n\nexport const Tools: React.FC = () => {\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\"\n      }}\n    >\n      <button className={\"Tools-items Tools-button\"}>\n        <PencilTool />\n      </button>\n      <button className={\"Tools-items Tools-button\"}>\n        <EraserTool />\n      </button>\n      <button className={\"Tools-items Tools-button\"}>\n        <EyeDropperTool />\n      </button>\n      <button className={\"Tools-items Tools-button\"}>\n        <FillTool />\n      </button>\n    </div>\n  );\n};\n","import { createTypedHooks } from \"easy-peasy\";\nimport { StoreModel } from \"./store\";\n\nconst typedHooks = createTypedHooks<StoreModel>();\n\nexport const useStoreActions = typedHooks.useStoreActions;\nexport const useStoreDispatch = typedHooks.useStoreDispatch;\nexport const useStoreState = typedHooks.useStoreState;\n","import React from \"react\";\nimport \"./ColorPalette.css\";\nimport { useStoreActions, useStoreState } from \"../../hooks\";\n\nconst AddIcon: React.FC = () => {\n  return (\n    <svg width=\"30\" height=\"30\" viewBox=\"0 0 1792 1792\">\n      <path\n        d=\"M1600 736v192q0 40-28 68t-68 28h-416v416q0 40-28 68t-68 28h-192q-40 0-68-28t-28-68v-416h-416q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h416v-416q0-40 28-68t68-28h192q40 0 68 28t28 68v416h416q40 0 68 28t28 68z\"\n        fill=\"#fff\"\n      />\n    </svg>\n  );\n};\n\nexport const ColorPalette: React.FC = () => {\n  const colors = useStoreState((state) => state.palette.colors) as string[];\n\n  const selectColor = useStoreActions((actions) => actions.palette.selectColor);\n\n  const handleClick = (index: number) => () => {\n    selectColor(index);\n  };\n\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n      }}\n    >\n      {colors.map((color, i) => (\n        <button\n          key={i}\n          onClick={handleClick(i)}\n          className={\"ColorPalette-items ColorPalette-button\"}\n          style={{\n            backgroundColor: color,\n            flex: 1,\n          }}\n        />\n      ))}\n\n      <button\n        className={\"ColorPalette-items ColorPalette-button\"}\n        style={{ minHeight: 48, maxHeight: 48, flex: 0 }}\n      >\n        <AddIcon />\n      </button>\n    </div>\n  );\n};\n","import { Color } from \"csstype\";\n\nexport interface CanvasContext {\n  ctx: CanvasRenderingContext2D;\n  width: number;\n  height: number;\n  brushSize: number;\n}\n\nexport const clear = ({ ctx, width, height }: CanvasContext) => {\n  ctx.clearRect(0, 0, width, height);\n};\n\nexport const checkerBoardPattern = (\n  canvasContext: CanvasContext,\n  {\n    squareSize,\n    firstColor,\n    secondColor\n  }: { squareSize: number; firstColor: string; secondColor: string }\n) => {\n  const { width, height } = canvasContext;\n  const columns = Math.ceil(width / squareSize);\n  let color = firstColor;\n\n  for (let i = 0; i < height; i += squareSize) {\n    for (let j = 0; j < width; j += squareSize) {\n      setColor(\n        {\n          ...canvasContext,\n          brushSize: squareSize\n        },\n        {\n          x: j,\n          y: i,\n          color\n        }\n      );\n      color = color === firstColor ? secondColor : firstColor;\n    }\n\n    // flip again if even columns\n    if (columns % 2 === 0) {\n      color = color === firstColor ? secondColor : firstColor;\n    }\n  }\n};\n\nexport const withinBound = (\n  { width, height }: CanvasContext,\n  { x, y }: { x: number; y: number }\n) => {\n  if (x < 0 || x >= width || y < 0 || y >= height) {\n    return false;\n  }\n  return true;\n};\n\nexport const line = (\n  canvasContext: CanvasContext,\n  {\n    x0,\n    y0,\n    x1,\n    y1,\n    color\n  }: {\n    x0: number;\n    y0: number;\n    x1: number;\n    y1: number;\n    color: string;\n  }\n) => {\n  const { width, height } = canvasContext;\n  const xClamp = clamp({\n    min: 0,\n    max: width - 1\n  });\n  const yClamp = clamp({\n    min: 0,\n    max: height - 1\n  });\n\n  x0 = xClamp(x0);\n  y0 = yClamp(y0);\n  x1 = xClamp(x1);\n  y1 = yClamp(y1);\n\n  const dx = Math.abs(x1 - x0);\n  const dy = Math.abs(y1 - y0);\n  const sx = x0 < x1 ? 1 : -1;\n  const sy = y0 < y1 ? 1 : -1;\n  let err = dx - dy;\n\n  while (true) {\n    setColor(canvasContext, { x: x0, y: y0, color });\n\n    //if we've reached the end goal, exit the loop\n    if (x0 === x1 && y0 === y1) {\n      break;\n    }\n    const e2 = 2 * err;\n    if (e2 > -dy) {\n      err -= dy;\n      x0 += sx;\n    }\n    if (e2 < dx) {\n      err += dx;\n      y0 += sy;\n    }\n  }\n};\n\nexport const setColor = (\n  canvasContext: CanvasContext,\n  { x, y, color }: { x: number; y: number; color: Color }\n) => {\n  const { ctx, brushSize } = canvasContext;\n  ctx.fillStyle = color;\n  ctx.fillRect(x, y, brushSize, brushSize);\n};\n\nconst clamp = ({ min, max }: { min: number; max: number }) => (\n  value: number\n) => {\n  return Math.min(Math.max(value, min), max);\n};\n","import React from \"react\";\nimport \"./Canvas.css\";\nimport { animated } from \"react-spring\";\n\ninterface Props {\n  width: number;\n  height: number;\n  animatedStyleProps: React.CSSProperties;\n  canvasRefCallback?: (instance: HTMLCanvasElement) => void;\n  bindGesture?: (...args: any[]) => any;\n  style?: React.CSSProperties;\n  className?: string;\n}\n\nconst _PureCanvas: React.FC<Props> = ({\n  width,\n  height,\n  animatedStyleProps,\n  canvasRefCallback,\n  bindGesture,\n  style,\n  className,\n}) => {\n  const gestureHandlers = bindGesture ? bindGesture() : {};\n  return (\n    <animated.canvas\n      {...gestureHandlers}\n      ref={canvasRefCallback}\n      width={width}\n      height={height}\n      className={\"Canvas-pixelated \" + className}\n      style={{ ...style, ...animatedStyleProps }}\n    />\n  );\n};\n\nexport const PureCanvas = React.memo(_PureCanvas);\n","import React, { useRef, useEffect, useCallback } from \"react\";\nimport {\n  CanvasContext,\n  clear,\n  line,\n  withinBound,\n  checkerBoardPattern,\n} from \"./canvas-fns\";\nimport { PureCanvas } from \"./PureCanvas\";\nimport { useGesture } from \"react-use-gesture\";\nimport { createPropGetter } from \"../../createPropGetter\";\nimport { useStoreState } from \"../../hooks\";\n\ntype Props = {} & Partial<DefaultProps>;\n\nconst defaultProps = {\n  transparentGridSize: 2,\n  transparentFirstColor: \"#B4AEB7\",\n  transparentSecondColor: \"#CCC8CE\",\n  animatedStyleProps: {} as React.CSSProperties,\n};\ntype DefaultProps = Readonly<typeof defaultProps>;\nconst getProps = createPropGetter(defaultProps);\n\nexport const PixelCanvas: React.FC<Props> = (props) => {\n  const {\n    transparentGridSize,\n    transparentFirstColor,\n    transparentSecondColor,\n    animatedStyleProps,\n  } = getProps(props);\n\n  const selectedColor = useStoreState((state) => state.palette.selectedColor);\n  const brushSize = useStoreState((state) => state.tool.brushSize);\n  const zoom = useStoreState((state) => state.canvas.zoom);\n  const width = useStoreState((state) => state.canvas.width);\n  const height = useStoreState((state) => state.canvas.height);\n\n  const getCanvasContext = (\n    ref?: React.MutableRefObject<HTMLCanvasElement | undefined>\n  ): CanvasContext => {\n    return Object.freeze({\n      ctx: (ref ? ref : canvasRef).current!.getContext(\"2d\")!,\n      width,\n      height,\n      brushSize,\n    } as CanvasContext);\n  };\n\n  // canvas setup\n  useEffect(() => {\n    const canvasContext = getCanvasContext();\n    canvasContext.ctx.imageSmoothingEnabled = true;\n    clear(canvasContext);\n\n    const backgroundCanvasContext = getCanvasContext(backgroundCanvasRef);\n    backgroundCanvasContext.ctx.imageSmoothingEnabled = true;\n    checkerBoardPattern(backgroundCanvasContext, {\n      squareSize: transparentGridSize,\n      firstColor: transparentFirstColor,\n      secondColor: transparentSecondColor,\n    });\n\n    // eslint-disable-next-line\n  }, []);\n\n  // canvas ref callback\n  const [canvasRef, canvasRefCallback] = useCanvasRef();\n  const [backgroundCanvasRef, backgroundCanvasRefCallback] = useCanvasRef();\n\n  // gesture for canvas\n  const bindGesture = useGesture({\n    onDrag: (state) => {\n      const [x0, y0] = state.previous;\n      const [x1, y1] = state.xy;\n      const canvas = canvasRef.current!;\n      const canvasRect = canvas.getBoundingClientRect();\n\n      const rectX0 = Math.floor((x0 - canvasRect.left) / zoom);\n      const rectY0 = Math.floor((y0 - canvasRect.top) / zoom);\n      const rectX1 = Math.floor((x1 - canvasRect.left) / zoom);\n      const rectY1 = Math.floor((y1 - canvasRect.top) / zoom);\n\n      // ignore if previous pos out of bound\n      if (!withinBound(getCanvasContext(), { x: rectX0, y: rectY0 })) {\n        return;\n      }\n\n      line(getCanvasContext(), {\n        x0: rectX0,\n        y0: rectY0,\n        x1: rectX1,\n        y1: rectY1,\n        color: selectedColor,\n      });\n    },\n  });\n\n  return (\n    <>\n      <PureCanvas\n        canvasRefCallback={backgroundCanvasRefCallback}\n        width={width}\n        height={height}\n        animatedStyleProps={animatedStyleProps}\n        className={\"Canvas-background\"}\n      />\n      <PureCanvas\n        canvasRefCallback={canvasRefCallback}\n        width={width}\n        height={height}\n        bindGesture={bindGesture}\n        animatedStyleProps={animatedStyleProps}\n        className={\"Canvas-main\"}\n      />\n    </>\n  );\n};\n\nPixelCanvas.defaultProps = defaultProps;\n\nconst useCanvasRef = (): [\n  React.MutableRefObject<HTMLCanvasElement>,\n  (node: any) => void\n] => {\n  const ref = useRef<HTMLCanvasElement>();\n  const callback = useCallback((node) => {\n    if (node) {\n      ref.current = node;\n    }\n  }, []);\n  return [ref as React.MutableRefObject<HTMLCanvasElement>, callback];\n};\n","export const createPropGetter = <DP extends object>(defaultProps: DP) => {\n    return <P extends Partial<DP>>(props: P) => {\n        type PropsExcludingDefaults = Pick<P, Exclude<keyof P, keyof DP>>\n        type RecomposedProps = DP & PropsExcludingDefaults\n        return (props as any) as RecomposedProps\n    }\n}","import React, { useEffect, useState, useRef } from \"react\";\nimport { useDimensions } from \"./useDimensions\";\nimport { PixelCanvas } from \"../pixel-canvas\";\nimport { useSpring } from \"react-spring\";\nimport { useStoreActions, useStoreState } from \"../../hooks\";\n\nexport const CanvasArea: React.FC = () => {\n  const [ref, domRect] = useDimensions();\n  const increaseZoom = useStoreActions(\n    (actions) => actions.canvas.increaseZoom\n  );\n  const decreaseZoom = useStoreActions(\n    (actions) => actions.canvas.decreaseZoom\n  );\n\n  const zoom = useStoreState((state) => state.canvas.zoom);\n  const width = useStoreState((state) => state.canvas.width);\n  const height = useStoreState((state) => state.canvas.height);\n\n  const [wheelXy, setWheelXy] = useState<{ x: number; y: number }>({\n    x: 0,\n    y: 0,\n  });\n\n  const animatedStyleProps = useAnimatedCanvasProps({\n    width,\n    height,\n    zoom,\n    parentDomRect: domRect,\n    wheelXy,\n  });\n\n  const handleWheel = (event: React.WheelEvent) => {\n    const deltaY = event.deltaY;\n    if (deltaY < 0) {\n      increaseZoom(-deltaY / 30);\n    } else {\n      decreaseZoom(deltaY / 30);\n    }\n    setWheelXy({ x: event.clientX, y: event.clientY });\n  };\n\n  return (\n    <div\n      ref={ref}\n      onWheel={handleWheel}\n      style={{ width: \"100%\", height: \"100%\" }}\n    >\n      <PixelCanvas animatedStyleProps={animatedStyleProps} />\n    </div>\n  );\n};\n\nconst toEven = (val: number) => {\n  if (val % 2 === 0) {\n    return val;\n  } else {\n    return val + 1;\n  }\n};\n\nconst useAnimatedCanvasProps = ({\n  width,\n  height,\n  zoom,\n  parentDomRect,\n  wheelXy,\n}: {\n  width: number;\n  height: number;\n  zoom: number;\n  parentDomRect: DOMRect;\n  wheelXy: { x: number; y: number };\n}): React.CSSProperties => {\n  const [animatedProps, setAnimatedProps] = useSpring(() => {\n    return {\n      width: zoom * width,\n      height: zoom * height,\n    };\n  });\n  useEffect(() => {\n    const w = zoom * width;\n    const h = zoom * height;\n    setAnimatedProps({\n      width: w,\n      height: h,\n    });\n  }, [width, height, zoom, setAnimatedProps]);\n\n  const previousZoom = usePrevious(zoom);\n\n  // TODO: enable pan and zoom control offset\n  const [animatedOffsetProps, setAnimatedOffsetProps] = useSpring(() => {\n    return {\n      left: 0,\n      top: 0,\n    };\n  });\n  const [canvasOffset, setCanvasOffset] = useState<{\n    left: number;\n    top: number;\n  }>({\n    left: 0,\n    top: 0,\n  });\n  useEffect(() => {\n    setAnimatedOffsetProps(canvasOffset);\n  }, [canvasOffset, setAnimatedOffsetProps]);\n\n  // offset to center once\n  const [initialized, setInitialized] = useState(false);\n  useEffect(() => {\n    if (initialized) {\n      return;\n    }\n    if (parentDomRect) {\n      setInitialized(true);\n      setCanvasOffset({\n        left: toEven(Math.floor((parentDomRect.width - width * zoom) / 2)),\n        top: toEven(Math.floor((parentDomRect.height - height * zoom) / 2)),\n      });\n    }\n  }, [width, height, zoom, initialized, parentDomRect]);\n\n  useEffect(() => {\n    if (!initialized) {\n      return;\n    }\n    if (canvasOffset.left === 0) {\n      return;\n    }\n    const wheelRelative = parentDomRect\n      ? {\n          x: wheelXy.x - parentDomRect.x,\n          y: wheelXy.y - parentDomRect.y,\n        }\n      : { x: 0, y: 0 };\n\n    const threshold = 2;\n    const leftDelta =\n      ((wheelRelative.x - canvasOffset.left) / previousZoom) *\n      (zoom - previousZoom);\n    const rightDelta =\n      ((wheelRelative.y - canvasOffset.top) / previousZoom) *\n      (zoom - previousZoom);\n    if (Math.abs(leftDelta) > threshold || Math.abs(rightDelta) > threshold) {\n      setCanvasOffset({\n        left: toEven(Math.floor(canvasOffset.left - leftDelta)),\n        top: toEven(Math.floor(canvasOffset.top - rightDelta)),\n      });\n    }\n  }, [\n    width,\n    height,\n    previousZoom,\n    canvasOffset,\n    zoom,\n    initialized,\n    parentDomRect,\n    wheelXy.x,\n    wheelXy.y,\n  ]);\n\n  return { ...animatedProps, ...animatedOffsetProps };\n};\n\nconst usePrevious = function <TValue>(value: TValue) {\n  const ref = useRef<TValue>(value);\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n  return ref.current;\n};\n","import { useState, useCallback, useLayoutEffect } from \"react\";\n\ntype UseDimensionsHook = [any, DOMRect, HTMLElement];\n\ninterface UseDimensionsArgs {\n  liveMeasure?: boolean;\n}\n\nexport const useDimensions = ({\n  liveMeasure = true,\n}: UseDimensionsArgs = {}): UseDimensionsHook => {\n  const [dimensions, setDimensions] = useState<DOMRect>();\n  const [node, setNode] = useState<HTMLElement>();\n\n  const ref = useCallback((node) => {\n    if (node) {\n      setNode(node);\n    }\n  }, []);\n\n  useLayoutEffect(() => {\n    if (node) {\n      const measure = () => {\n        window.requestAnimationFrame(() => {\n          if (node) {\n            const domRect = node.getBoundingClientRect() as DOMRect;\n            setDimensions(domRect);\n          }\n        });\n      };\n      measure();\n\n      if (liveMeasure) {\n        window.addEventListener(\"resize\", measure);\n        window.addEventListener(\"scroll\", measure);\n\n        return () => {\n          window.removeEventListener(\"resize\", measure);\n          window.removeEventListener(\"scroll\", measure);\n        };\n      }\n    }\n  }, [node, liveMeasure]);\n\n  return [ref, dimensions!, node!];\n};\n","import React from \"react\";\nimport { StoreProvider } from \"easy-peasy\";\nimport { store } from \"./../store\";\nimport { Layout } from \"../layout\";\nimport { Menu } from \"../components/menu\";\nimport { Tools } from \"../components/tool\";\nimport { ColorPalette } from \"../components/color-palette\";\nimport { CanvasArea } from \"../components/canvas-area\";\n\nexport const App: React.FC = () => {\n  return (\n    <StoreProvider store={store as any}>\n      <Layout\n        top={<Menu />}\n        left={<Tools />}\n        // middle={<div></div>}\n        middle={<CanvasArea />}\n        right={<ColorPalette />}\n      />\n    </StoreProvider>\n  );\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport { App } from \"./app\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}